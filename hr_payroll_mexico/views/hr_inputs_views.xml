<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <data noupdate="1">
<!--        <delete model="ir.ui.menu" id="hr_work_entry_contract.menu_work_entry"/>-->
<!--        <delete model="ir.ui.menu" id="hr_work_entry_contract.menu_work_entry_conflicts"/>-->
<!--        <delete model="ir.ui.menu" id="hr_work_entry_contract.menu_hr_payroll_work_entries_root"/>-->

        <delete model="ir.actions.act_window.view" id="hr_work_entry_contract.hr_work_entry_action_view_gantt"/>
        <delete model="ir.actions.act_window.view" id="hr_work_entry_contract.hr_work_entry_action_conflict_view_gantt"/>
    </data>

    <data>

    <record model="ir.ui.view" id="hr_work_entry_contract.hr_work_entry_gantt">
        <field name="active">0</field>
    </record>

    <record id="hr_work_entry.hr_work_entry_action_conflict" model="ir.actions.act_window">
        <field name="name">Work Entry</field>
        <field name="res_model">hr.work.entry</field>
        <field name="context">{'search_default_work_entries_error': 1}</field>
        <field name="view_mode">tree,form,pivot</field>
    </record>

    <record id="hr_work_entry.hr_work_entry_action" model="ir.actions.act_window">
        <field name="name">Work Entry</field>
        <field name="res_model">hr.work.entry</field>
        <field name="view_mode">tree,form,pivot</field>
    </record>

    <record model="ir.ui.view" id="payroll_hr_work_entry_type_view_form_inherit_contract">
        <field name="name">hr.work.entry.type.contract.form.mexico</field>
        <field name="model">hr.work.entry.type</field>
        <field name="inherit_id" ref="hr_payroll.payroll_hr_work_entry_type_view_form_inherit_contract"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='is_unforeseen']" position="replace">
                <field name="is_unforeseen" invisible="1"/>
            </xpath>
            <xpath expr="//field[@name='is_leave']" position="after">
                <field name="type_leave" attrs="{'invisible': [('is_leave', '!=', True)],'required': [('is_leave', '=', True)]}"/>
            </xpath>
        </field>
    </record>

    <record model="ir.ui.view" id="payroll_hr_work_entry_type_view_form_inherit_leave">
        <field name="name">hr.work.entry.type.leave.form.mexico</field>
        <field name="model">hr.work.entry.type</field>
        <field name="inherit_id" ref="hr_work_entry_holidays.payroll_leave_hr_work_entry_type_view_form_inherit"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='leave_type_ids']" position="replace">
                <field name="leave_type_ids" widget="many2many_tags" invisible="1"/>
            </xpath>
        </field>
    </record>

    <record model="ir.ui.view" id="hr_payroll.payroll_hr_work_entry_type_view_form_inherit">
        <field name="active">0</field>
    </record>

    <!--  Inputs  -->
    <record id="hr_payslip_input_type_view_form" model="ir.ui.view">
        <field name="name">hr.payslip.input.type.inherit.view.form</field>
        <field name="model">hr.payslip.input.type</field>
        <field name="inherit_id" ref="hr_payroll.hr_payslip_input_type_view_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='code']" position="after">
                <field name="requires_date"/>
            </xpath>
        </field>
    </record>


    <record id="view_hr_inputs_form" model="ir.ui.view">
        <field name="name">hr.inputs.form</field>
        <field name="model">hr.inputs</field>
        <field name="arch" type="xml">
            <form string="Inputs">
                  <header>
                      <field name="state" widget="statusbar" statusbar_visible="confirm,approve,paid"
                      options="{'clickable': '1'}"/>
                  </header>
                  <sheet>
                      <group>
                          <group>
                              <field name="employee_id"/>
                              <field name="payroll_period_id" domain="[('state', 'in', ['open'])]"
                                     attrs="{'readonly': [('state', 'in', ['cancel', 'approve', 'rejected'])]}"/>
                          </group>
                          <group>
                              <field name="input_id" attrs="{'readonly': [('state', 'in', ['cancel', 'approve', 'rejected'])]}"/>
                              <field name="amount" attrs="{'readonly': [('state', 'in', ['cancel', 'approve', 'rejected'])]}"/>
                              <field name="date" attrs="{'required': [('requires_date', '=', True)], 'readonly': [('state', 'in', ['cancel', 'approve', 'rejected'])]}"/>
                              <field name="requires_date" invisible="1"/>
                          </group>
                      </group>
                  </sheet>
                  <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="activity_ids" widget="mail_activity"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
            </form>
         </field>
    </record>

    <record id="view_hr_inputs_tree" model="ir.ui.view">
        <field name="name">hr.inputs.tree</field>
        <field name="model">hr.inputs</field>
        <field name="arch" type="xml">
            <tree>
                <field name="employee_id"/>
                <field name="input_id"/>
                <field name="amount"/>
                <field name="state"/>
            </tree>
        </field>
    </record>

    <record id="view_hr_inputs_pivot" model="ir.ui.view">
        <field name="name">hr.inputs.pivot</field>
        <field name="model">hr.inputs</field>
        <field name="arch" type="xml">
            <pivot string="Inputs">
                <field name="employee_id" type="row"/>
                <field name="amount" type="measure"/>
                <field name="input_id" type="col"/>
            </pivot>
        </field>
    </record>

    <record id="view_hr_inputs_action" model="ir.actions.act_window">
        <field name="name">Inputs</field>
        <field name="res_model">hr.inputs</field>
        <field name="view_mode">tree,pivot,form</field>
    </record>

    <record model="ir.actions.server" id="action_inputs_approval">
        <field name="name">Inputs Approval</field>
        <field name="model_id" ref="model_hr_inputs"/>
        <field name="binding_model_id" ref="model_hr_inputs"/>
        <field name="binding_view_types">list</field>
        <field name="state">code</field>
        <field name="code">
            if records:
                records.action_approve()
        </field>
    </record>

    <record model="ir.actions.server" id="action_inputs_disapprove">
        <field name="name">Inputs Disapproval</field>
        <field name="model_id" ref="model_hr_inputs"/>
        <field name="binding_model_id" ref="model_hr_inputs"/>
        <field name="binding_view_types">list</field>
        <field name="state">code</field>
        <field name="code">
            if records:
                records.action_disapprove()
        </field>
    </record>

    <!--    -->
    <record id="view_input_with_share_form" model="ir.ui.view">
        <field name="name">input.with.share.form</field>
        <field name="model">input.with.share</field>
        <field name="arch" type="xml">
            <form string="Input with Share">
            <header>
                <field name="state" widget="statusbar" options="{'clickable': '1'}"/>
            </header>
            <sheet>
            <div class="oe_title">
                <label for="employee_id" class="oe_edit_only"/>
                <h1>
                    <field name="employee_id" placeholder="Employee" required="True"/>
                </h1>
            </div>
            <group>
                <group>
                    <field name="amount" attrs="{'readonly': [('line_ids', '!=', [])]}"/>
                    <field name="amount_of_fees" attrs="{'readonly': [('line_ids', '!=', [])]}"/>
                    <field name="paid_amount" readonly="1"/>
                    <field name="outstanding_balance" readonly="1"/>
                </group>
                <group>
                    <field name="input_id" attrs="{'readonly': [('line_ids', '!=', [])]}"/>
                </group>
            </group>
            <notebook>
                <page string="Lines">
                    <field name="line_ids" readonly="1">
                        <tree>
                            <field name="slip_id"/>
                            <field name="amount"/>
                            <field name="input_id"/>
                        </tree>
                        <form>
                            <group>
                                <group>
                                    <field name="slip_id"/>
                                    <field name="amount"/>
                                </group>
                            </group>
                        </form>
                    </field>
                </page>
            </notebook>
            </sheet>
            <div class="oe_chatter">
                <field name="message_follower_ids" widget="mail_followers"/>
                <field name="activity_ids" widget="mail_activity"/>
                <field name="message_ids" widget="mail_thread"/>
            </div>
            </form>
         </field>
    </record>

    <record id="view_input_with_share_tree" model="ir.ui.view">
        <field name="name">input.with.share.tree</field>
        <field name="model">input.with.share</field>
        <field name="arch" type="xml">
            <tree>
                <field name="employee_id"/>
                <field name="input_id"/>
                <field name="amount"/>
                <field name="amount_of_fees"/>
                <field name="outstanding_balance"/>
                <field name="state"/>
            </tree>
        </field>
    </record>

    <record id="view_input_with_share_action" model="ir.actions.act_window">
        <field name="name">Input with Share</field>
        <field name="res_model">input.with.share</field>
        <field name="view_mode">tree,pivot,form</field>
    </record>

    <menuitem
        name="Payslip Inputs"
        id="menu_hr_inputs_payslips"
        parent="hr_work_entry_contract.menu_hr_payroll_root" sequence="60"/>

    <menuitem
        name="Inputs"
        id="menu_hr_inputs"
        action="view_hr_inputs_action"
        parent="menu_hr_inputs_payslips" sequence="10"/>

    <menuitem
        name="Inputs With Share"
        id="menu_hr_inputs_with_share"
        action="view_input_with_share_action"
        parent="menu_hr_inputs_payslips" sequence="15"/>

    </data>
</odoo>
